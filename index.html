<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Studio De l'Arnet ‚Äî Mixer Magic</title>

<!-- Google Fonts for vibe-specific typography -->
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Montserrat:wght@700;900&family=Cormorant+Garamond:wght@600;700&family=Raleway:wght@400;700&family=Bangers&family=Lora:wght@400;700&family=Kalam:wght@400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg1: #1a1a2e;
    --bg2: #4b0082;
    --glass: rgba(255,255,255,0.04);
    --muted: #cfc8dd;
  }

  /* Page basics */
  html,body{height:100%;margin:0;}
  body{
    font-family: "Raleway", Arial, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
    margin:0;padding:0;
    background: linear-gradient(135deg,var(--bg1),var(--bg2));
    color:#fff;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    text-align:center;
  }

  .wrap{
    max-width:980px;margin:0 auto;padding:20px;
  }

  header{
    padding-top:20px;padding-bottom:6px;
  }

  h1{
    margin:0;
    font-size:2.25rem;
    letter-spacing:0.6px;
    text-shadow:0 6px 18px rgba(0,0,0,0.6);
  }

  p.lead{
    margin-top:8px;margin-bottom:14px;color:var(--muted);
    font-size:1rem;
  }

  /* homepage preview area */
  #homepage {
    position:relative;
    width:100%;
    height:240px;
    overflow:hidden;
    margin:18px 0 22px 0;
    border-radius:14px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
    box-shadow: 0 8px 30px rgba(0,0,0,0.6);
    border:1px solid rgba(255,255,255,0.03);
  }

  /* Polaroid previews (floating) - decorative */
  .mini-polaroid{
    width:88px;height:112px;background:#fff;border-radius:10px;box-shadow:0 8px 22px rgba(0,0,0,0.5);
    transform-origin:center center;
  }

  /* Primary CTA buttons */
  .cta-row{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;margin-top:8px}
  .btn{
    border:0;padding:14px 20px;border-radius:12px;font-weight:700;cursor:pointer;font-size:1.05rem;transition:transform .14s ease, box-shadow .14s ease;
  }
  .btn:active{transform:translateY(2px)}
  .fortune-btn{background: linear-gradient(90deg,#ff7a66,#ff5b8a); color:#fff; box-shadow:0 10px 30px rgba(255,90,120,0.12)}
  .song-btn{background: linear-gradient(90deg,#ffd76a,#ffd14b); color:#071018; box-shadow:0 10px 30px rgba(255,210,80,0.12)}
  .vibe-btn{background:var(--glass); color:var(--muted); padding:12px 14px; border-radius:12px; font-weight:700; border:1px solid rgba(255,255,255,0.04)}

  /* Vibes grid */
  #vibeGrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px;margin-top:16px}

  .vibe-card{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04));
    padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);
    display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:86px;
    cursor:pointer;transition:transform .12s ease, box-shadow .12s ease;
  }
  .vibe-card:hover{transform:translateY(-6px);box-shadow:0 8px 30px rgba(0,0,0,0.5)}

  .vibe-emoji{font-size:22px}
  .vibe-label{margin-top:8px;font-weight:700}

  /* Result card */
  .result-card{
    margin:20px auto;padding:18px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));max-width:560px;border:1px solid rgba(255,255,255,0.04);
  }
  .result-title{font-weight:800;font-size:1.1rem}
  .result-text{margin-top:10px;color:var(--muted);line-height:1.45;font-size:1rem}

  /* Extras row */
  .extras{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:12px}

  /* Share canvas */
  #shareCard{display:block;margin:16px auto;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.5)}

  /* FOOTER small */
  footer{margin-top:18px;color:var(--muted);font-size:0.9rem;padding-bottom:30px}
  
  /* Small screens */
  @media (max-width:520px){
    h1{font-size:1.6rem}
    #homepage{height:180px}
    .mini-polaroid{width:66px;height:86px}
    .btn{padding:12px 14px;font-size:1rem}
  }
</style>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>Studio De l'Arnet ‚Äî Mixer Magic ‚ú®üéß</h1>
      <p class="lead">Choose Fortune or Theme Song ‚Üí pick your vibe ‚Üí reveal your collectible card. One reveal per device.</p>
    </header>

    <!-- Homepage preview / sparkles -->
    <div id="homepage">
      <canvas id="sparkleCanvas" width="800" height="240" style="width:100%;height:100%;display:block;border-radius:14px"></canvas>

      <!-- decorative floating polaroids -->
      <div style="position:absolute;left:18px;top:18px;transform:rotate(-12deg);">
        <div class="mini-polaroid"></div>
      </div>
      <div style="position:absolute;left:120px;top:34px;transform:rotate(6deg);">
        <div class="mini-polaroid"></div>
      </div>
      <div style="position:absolute;left:236px;top:10px;transform:rotate(-4deg);">
        <div class="mini-polaroid"></div>
      </div>
    </div>

    <!-- Step 1 -->
    <div id="step1" style="margin-top:6px">
      <div class="cta-row">
        <button id="fortuneBtn" class="btn fortune-btn">Give Me My 2026 Fortune üîÆ</button>
        <button id="songBtn" class="btn song-btn">Give Me My 2026 Theme Song üéµ</button>
      </div>
    </div>

    <!-- Step 2: Vibe pick -->
    <div id="step2" class="hidden">
      <h2 id="vibePrompt">Pick your vibe</h2>
      <div id="vibeGrid"></div>
      <div style="margin-top:10px">
        <button id="backBtn" class="btn vibe-btn">‚Üê Back</button>
      </div>
    </div>

    <!-- Step 3: Result -->
    <div id="step3" class="hidden">
      <div id="resultArea" class="result-card">
        <div id="resultTitle" class="result-title"></div>
        <div id="resultText" class="result-text"></div>
      </div>

      <div id="extras" class="extras hidden">
        <button id="spotifyBtn" class="btn song-btn hidden">Save to Spotify üéµ</button>
        <button id="shareBtn" class="btn vibe-btn">Share Your Vibe Card üì∏</button>
      </div>

      <canvas id="shareCard" class="hidden"></canvas>
    </div>

    <footer>Studio De l'Arnet ‚Ä¢ @studio.del.arnet</footer>
  </div>
<!-- end wrap -->

<!-- NEXT: JavaScript (message 2) -->
<script>
/* ---------------------------
   SITE LOGIC + INTERACTIONS
   --------------------------- */

const vibes = [
  { key: "Playful", label: "‚ú® Playful", emoji: "‚ú®", font: "'Fredoka One', cursive", gradient: ["#ff9a9e","#fad0c4"] },
  { key: "Fierce", label: "üî• Fierce", emoji: "üî•", font: "'Montserrat', sans-serif", gradient: ["#ff416c","#ff4b2b"] },
  { key: "Mysterious", label: "üîÆ Mysterious", emoji: "üîÆ", font: "'Cormorant Garamond', serif", gradient: ["#2c3e50","#4ca1af"] },
  { key: "Creative", label: "üé® Creative", emoji: "üé®", font: "'Raleway', sans-serif", gradient: ["#43cea2","#185a9d"] },
  { key: "Chaos", label: "ü§° Chaos", emoji: "ü§°", font: "'Bangers', cursive", gradient: ["#f7971e","#ffd200"] },
  { key: "Grounded", label: "üßò Grounded", emoji: "üßò", font: "'Lora', serif", gradient: ["#00c6ff","#0072ff"] },
  { key: "Wildcard", label: "üé≤ Wildcard", emoji: "üé≤", font: "'Kalam', cursive", gradient: ["#fbc2eb","#a6c1ee"] }
];

/* --- Sample fortunes & songs (replace or expand later) --- */
const fortunes = {
  Playful: [
    "Your laughter is your superpower; use it liberally this year.",
    "Unexpected joy will find you in the most curious places.",
    "A playful impulse becomes the bridge to someone who shares your odd sense of humor."
  ],
  Fierce: [
    "2026 is your year to roar; your boldness opens doors.",
    "Confidence becomes practical power‚Äîspeak the plan and schedule the steps.",
    "A leadership opportunity appears disguised as a small ask; accept it and prove how quietly decisive you can be."
  ],
  Mysterious: [
    "A quiet intuition blooms into a helpful guide; listen to small, repeated nudges.",
    "You will notice a pattern no one else has named ‚Äî use that insight.",
    "A subtle shift reveals new creative space; rearrange one thing and watch the rest breathe easier."
  ],
  Creative: [
    "A new idea grows when you let two unexpected things collide.",
    "Your imagination is a magnet for exciting opportunities.",
    "A creative routine that rewards consistency appears‚Äîprotect that time."
  ],
  Chaos: [
    "A delightful disruption shifts your routine; lean into the mess and find the emergent opportunity.",
    "A wild idea asks for a test‚Äîtry a tiny pilot and enjoy what you learn.",
    "Your willingness to take creative risks will magnetize others‚Äîchaos with heart builds community."
  ],
  Grounded: [
    "A steady habit anchors an unpredictable week; build one slow ritual and guard it like a lighthouse.",
    "Financial steadiness appears when you make small, repeatable choices.",
    "A simple daily practice brings surprising joy and becomes a soft daily gift."
  ],
  Wildcard: [
    "Something delightful and unusual will brighten your day.",
    "Expect the unexpected and relish it.",
    "A surprising detour becomes a favorite story‚Äîcollect the good bits."
  ]
};

const songs = {
  Playful: ["Good Times - Chic","Walking on Sunshine - Katrina & The Waves","September - Earth, Wind & Fire"],
  Fierce: ["Eye of the Tiger - Survivor","Respect - Aretha Franklin","Barracuda - Heart"],
  Mysterious: ["Dreams - Fleetwood Mac","Riders on the Storm - The Doors","Black Magic Woman - Santana"],
  Creative: ["Bohemian Rhapsody - Queen","Life on Mars? - David Bowie","Superstition - Stevie Wonder"],
  Chaos: ["Sabotage - Beastie Boys","Shake It Out - Florence + The Machine","Crosstown Traffic - Jimi Hendrix"],
  Grounded: ["Lovely Day - Bill Withers","Here Comes The Sun - The Beatles","Lean on Me - Bill Withers"],
  Wildcard: ["Space Oddity - David Bowie","Starman - David Bowie","Magic Carpet Ride - Steppenwolf"]
};

/* ---------- UI elements ---------- */
const step1 = document.getElementById('step1');
const step2 = document.getElementById('step2');
const step3 = document.getElementById('step3');
const vibeGrid = document.getElementById('vibeGrid');
const backBtn = document.getElementById('backBtn');
const resultTitle = document.getElementById('resultTitle');
const resultText = document.getElementById('resultText');
const extrasRow = document.getElementById('extras');
const spotifyBtn = document.getElementById('spotifyBtn');
const shareBtn = document.getElementById('shareBtn');
const shareCanvas = document.getElementById('shareCard');
const sparkleCanvas = document.getElementById('sparkleCanvas');

/* State */
let mode = null;         // 'fortune' or 'song'
let chosenVibe = null;   // key string
let chosenText = null;   // fortune text or song string

/* One reveal per device */
const REVEAL_KEY = 'studio_vibe_revealed';

/* ---------- Helpers ---------- */
function show(el){ el.classList.remove('hidden'); }
function hide(el){ el.classList.add('hidden'); }
function rand(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

/* ---------- build vibe grid ---------- */
function renderVibes(){
  vibeGrid.innerHTML = '';
  vibes.forEach(v=>{
    const card = document.createElement('div');
    card.className = 'vibe-card';
    card.innerHTML = `<div class="vibe-emoji">${v.emoji}</div><div class="vibe-label">${v.label}</div>`;
    card.addEventListener('click', ()=> onVibeClick(v.key));
    vibeGrid.appendChild(card);
  });
}

/* ---------- mode selection ---------- */
function startMode(selected){
  if(localStorage.getItem(REVEAL_KEY)){
    alert("One reveal per device ‚Äî thanks! If you'd like another, try a different device.");
    return;
  }
  mode = selected;
  hide(step1);
  renderVibes();
  show(step2);
  document.getElementById('vibePrompt').textContent = mode === 'fortune' ? "Pick your vibe for a Fortune üîÆ" : "Pick your vibe for a Theme Song üéµ";
}

/* ---------- back ---------- */
backBtn.addEventListener('click', ()=>{
  hide(step2);
  show(step1);
});

/* ---------- vibe chosen ---------- */
function onVibeClick(vibeKey){
  chosenVibe = vibeKey;
  // select text
  if(mode === 'fortune'){
    const list = fortunes[vibeKey] || fortunes.Wildcard;
    chosenText = rand(list);
    resultTitle.innerText = "üîÆ Your 2026 Fortune";
    resultText.innerText = chosenText;
    hide(spotifyBtn);
  } else {
    const list = songs[vibeKey] || songs.Wildcard;
    chosenText = rand(list);
    resultTitle.innerText = "üéµ Your 2026 Theme Song";
    resultText.innerText = chosenText;
    show(spotifyBtn);
  }

  hide(step2);
  show(step3);
  show(extrasRow);
  // store reveal
  localStorage.setItem(REVEAL_KEY, new Date().toISOString());
  // confetti
  launchConfetti();
}

/* ---------- Spotify ---------- */
spotifyBtn.addEventListener('click', saveToSpotify);
function saveToSpotify(){
  if(!chosenText) return;
  const q = encodeURIComponent(chosenText);
  window.open(`https://open.spotify.com/search/${q}`,'_blank');
}

/* ---------- Confetti animation (lightweight) ---------- */
function launchConfetti(){
  const duration = 1800;
  const end = Date.now() + duration;
  const colors = ['#ff0a54','#ff477e','#ff85a1','#ffd76a','#7ef0d6','#f0f0f0'];

  const confettiCanvas = document.createElement('canvas');
  confettiCanvas.style.position = 'fixed';
  confettiCanvas.style.top = 0;
  confettiCanvas.style.left = 0;
  confettiCanvas.style.width = '100%';
  confettiCanvas.style.height = '100%';
  confettiCanvas.style.pointerEvents = 'none';
  confettiCanvas.style.zIndex = 9999;
  document.body.appendChild(confettiCanvas);

  const ctx = confettiCanvas.getContext('2d');
  confettiCanvas.width = window.innerWidth;
  confettiCanvas.height = window.innerHeight;

  const confettis = [];
  for(let i=0;i<160;i++){
    confettis.push({
      x: Math.random()*confettiCanvas.width,
      y: Math.random()*confettiCanvas.height - confettiCanvas.height,
      r: 2 + Math.random()*6,
      color: colors[Math.floor(Math.random()*colors.length)],
      speed: 2 + Math.random()*4,
      tilt: Math.random()*10 - 5
    });
  }

  function frame(){
    ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
    confettis.forEach(c=>{
      ctx.beginPath();
      ctx.moveTo(c.x + c.tilt, c.y);
      ctx.lineTo(c.x, c.y + c.r*2);
      ctx.strokeStyle = c.color;
      ctx.lineWidth = c.r;
      ctx.stroke();
      c.y += c.speed;
      c.tilt += 0.3;
      if(c.y > confettiCanvas.height + 40){
        c.y = -20;
        c.x = Math.random()*confettiCanvas.width;
      }
    });
    if(Date.now() < end) requestAnimationFrame(frame);
    else document.body.removeChild(confettiCanvas);
  }
  frame();
}

/* ---------- Polaroid share card generator (high-res) ---------- */
function sharePolaroid(){
  if(!chosenText || !chosenVibe) return;

  // find vibe meta
  const vibeMeta = vibes.find(v => v.key === chosenVibe) || vibes[vibes.length-1];

  // high resolution canvas (for nice download)
  const W = 1200;   // wide for crispness
  const H = 1500;   // tall (polaroid vertical)
  shareCanvas.width = W;
  shareCanvas.height = H;
  shareCanvas.style.width = (Math.min(window.innerWidth - 40, 420)) + 'px'; // display size
  shareCanvas.style.height = ( (H/W) * Math.min(window.innerWidth - 40, 420) ) + 'px';

  const ctx = shareCanvas.getContext('2d');

  // background gradient
  const g = ctx.createLinearGradient(0,0,0,H);
  g.addColorStop(0, vibeMeta.gradient[0]);
  g.addColorStop(1, vibeMeta.gradient[1]);
  ctx.fillStyle = g;
  ctx.fillRect(0,0,W,H);

  // polaroid white frame
  const pad = Math.round(W*0.04);
  const frameW = W - pad*2;
  const frameH = H - pad*2;
  ctx.fillStyle = "#ffffff";
  // outer rounded rect (polaroid area) - draw white card then inner colored area
  roundRect(ctx, pad, pad, frameW, frameH, 30);
  ctx.fill();

  // inner colored art area (offset a bit down to leave thicker bottom)
  const innerPad = pad + 18;
  const innerW = frameW - 36;
  const innerH = frameH - 160; // leave big bottom area for polaroid text
  // draw rounded inner with vibe gradient but slightly transparent
  const innerGrad = ctx.createLinearGradient(0,innerPad,0,innerPad+innerH);
  innerGrad.addColorStop(0, blendHex(vibeMeta.gradient[0], '#ffffff', 0.06));
  innerGrad.addColorStop(1, blendHex(vibeMeta.gradient[1], '#ffffff', 0.06));
  ctx.fillStyle = innerGrad;
  roundRect(ctx, innerPad, innerPad, innerW, innerH, 20);
  ctx.fill();

  // decorative small sparkles/icons in inner area
  for(let i=0;i<28;i++){
    ctx.fillStyle = 'rgba(255,255,255,' + (0.06 + Math.random()*0.14) + ')';
    const rx = innerPad + Math.random()*(innerW-40) + 20;
    const ry = innerPad + Math.random()*(innerH-80) + 40;
    ctx.beginPath(); ctx.arc(rx,ry, 1 + Math.random()*3, 0, Math.PI*2); ctx.fill();
  }

  // big header text (mode)
  ctx.textAlign = 'center';
  ctx.fillStyle = '#fff';
  ctx.font = `bold 56px ${stripFontQuotes(vibeMeta.font)}`; // use vibe font for header
  ctx.fillText(mode === 'fortune' ? "üîÆ Your 2026 Fortune" : "üéµ Your 2026 Theme Song", W/2, innerPad + 64);

  // vibe emoji under header
  ctx.font = `48px ${stripFontQuotes(vibeMeta.font)}`;
  ctx.fillText( vibes.find(v=>v.key===chosenVibe).emoji, W/2, innerPad + 120);

  // main text block (wrap)
  ctx.fillStyle = '#0b0b0b';
  // set font for main text using vibe-specific font or fallback
  // slightly smaller and regular weight
  const mainFontSize = 44;
  ctx.font = `normal ${mainFontSize}px ${stripFontQuotes(vibeMeta.font)}`;
  const textX = innerPad + 40;
  const textYStart = innerPad + 200;
  const textWidth = innerW - 80;
  wrapTextCanvas(ctx, chosenText, textX, textYStart, textWidth, mainFontSize + 12);

  // thin divider line above footer
  ctx.strokeStyle = 'rgba(0,0,0,0.06)';
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(pad + 20, innerPad + innerH + 8);
  ctx.lineTo(pad + frameW - 20, innerPad + innerH + 8);
  ctx.stroke();

  // footer: Studio De l'Arnet and IG handle on the polaroid bottom
  ctx.fillStyle = '#000';
  ctx.font = `700 28px ${stripFontQuotes(vibeMeta.font)}`;
  ctx.textAlign = 'center';
  ctx.fillText("Studio De l'Arnet ‚ú® @studio.del.arnet", W/2, innerPad + innerH + 64);

  // small accent - mode icon left
  ctx.font = `24px ${stripFontQuotes(vibeMeta.font)}`;
  ctx.fillStyle = '#000';
  ctx.textAlign = 'left';
  ctx.fillText(mode === 'fortune'? 'üîÆ' : 'üéß', pad + 28, innerPad + innerH + 64);

  // done ‚Äî show canvas
  show(shareCanvas);

  // automatically trigger download prompt for user if they want (we'll show a prompt)
  setTimeout(()=>{
    // create download link
    const url = shareCanvas.toDataURL('image/png');
    // open native share on supported devices
    if(navigator.share){
      // try share only the image URL (some browsers may not allow blob)
      fetch(url).then(res => res.blob()).then(blob => {
        const file = new File([blob], `StudioDeLArnet_${chosenVibe}.png`, { type: 'image/png' });
        navigator.share({
          title: "My Studio De l'Arnet Vibe Card",
          text: `${mode === 'fortune' ? 'My 2026 Fortune' : 'My 2026 Theme Song'} ‚Äî ${chosenVibe}`,
          files: [file],
        }).catch(()=>{/* ignore share errors silently */});
      }).catch(()=>{/* ignore fetch/share errors */});
    }
  }, 600);
}

/* ---------- UTIL: rounded rect ---------- */
function roundRect(ctx, x, y, w, h, r){
  ctx.beginPath();
  ctx.moveTo(x + r, y);
  ctx.arcTo(x + w, y, x + w, y + h, r);
  ctx.arcTo(x + w, y + h, x, y + h, r);
  ctx.arcTo(x, y + h, x, y, r);
  ctx.arcTo(x, y, x + w, y, r);
  ctx.closePath();
}

/* ---------- UTIL: text wrapping for canvas ---------- */
function wrapTextCanvas(ctx, text, x, y, maxWidth, lineHeight){
  // split into words and lines
  const words = text.split(' ');
  let line = '';
  let currY = y;
  for(let n = 0; n < words.length; n++){
    const testLine = line + words[n] + ' ';
    const metrics = ctx.measureText(testLine);
    if(metrics.width > maxWidth && n > 0){
      ctx.fillText(line, x + maxWidth/2, currY);
      line = words[n] + ' ';
      currY += lineHeight;
    } else {
      line = testLine;
    }
  }
  ctx.fillText(line, x + maxWidth/2, currY);
}

/* ---------- UTIL: strip quotes for canvas font usage ---------- */
function stripFontQuotes(fontString){
  // google font family string may include quotes; remove any commas and quotes for canvas use
  return fontString.replace(/['"]/g, '').split(',')[0];
}

/* ---------- UTIL: blend color (simple) ---------- */
function blendHex(hex1, hex2, amount){
  // hex to rgb
  const c1 = hex1.replace('#','');
  const c2 = hex2.replace('#','');
  const r1 = parseInt(c1.substring(0,2),16), g1 = parseInt(c1.substring(2,4),16), b1 = parseInt(c1.substring(4,6),16);
  const r2 = parseInt(c2.substring(0,2),16), g2 = parseInt(c2.substring(2,4),16), b2 = parseInt(c2.substring(4,6),16);
  const r = Math.round(r1 + (r2 - r1) * amount);
  const g = Math.round(g1 + (g2 - g1) * amount);
  const b = Math.round(b1 + (b2 - b1) * amount);
  return '#' + [r,g,b].map(v => v.toString(16).padStart(2,'0')).join('');
}

/* ---------- Sparkle background animation (homepage) ---------- */
(function sparklesInit(){
  const c = sparkleCanvas;
  const ctx = c.getContext('2d');
  function resize(){ c.width = c.clientWidth; c.height = c.clientHeight; }
  resize();
  window.addEventListener('resize', resize);
  const dots = [];
  for(let i=0;i<60;i++){
    dots.push({ x: Math.random()*c.width, y: Math.random()*c.height, r:1 + Math.random()*2, t: Math.random()*1000 });
  }
  function draw(){
    ctx.clearRect(0,0,c.width,c.height);
    dots.forEach(d=>{
      ctx.beginPath();
      ctx.arc(d.x, d.y, d.r, 0, Math.PI*2);
      ctx.fillStyle = 'rgba(255,255,255,' + (0.15 + 0.5*Math.abs(Math.sin((Date.now()+d.t)/800))) + ')';
      ctx.fill();
    });
    requestAnimationFrame(draw);
  }
  draw();
})();

/* ---------- Setup on DOM ready ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  // attach UI events
  document.getElementById('fortuneBtn').addEventListener('click', ()=> startMode('fortune'));
  document.getElementById('songBtn').addEventListener('click', ()=> startMode('song'));
  document.getElementById('backBtn').addEventListener('click', ()=> { hide(step2); show(step1); });
  document.getElementById('shareBtn').addEventListener('click', ()=> {
    sharePolaroid();
    // also offer a download link
    setTimeout(()=> {
      const link = document.createElement('a');
      link.href = shareCanvas.toDataURL('image/png');
      link.download = `StudioDeLArnet_${chosenVibe}.png`;
      link.click();
    }, 900); // wait briefly to ensure canvas rendered
  });

  renderVibes();
});

/* ---------- Enforce one reveal per device UI state ---------- */
(function checkReveal(){
  if(localStorage.getItem(REVEAL_KEY)){
    // optional: show a subtle message or disable CTAs
    // hide(step1);
    // show a small notice? for now we just let them see the UI but clicking will alert
  }
})();

</script>
</body>
</html>
